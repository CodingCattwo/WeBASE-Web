(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"16me":function(t,a,e){"use strict";var n=e("o+l6");e.n(n).a},"3OG1":function(t,a,e){"use strict";var n=e("UZru");e.n(n).a},UZru:function(t,a,e){},bxjF:function(t,a,e){"use strict";var n=e("gDS+"),s=e.n(n),i=e("mHBk"),o=e("DgvE"),c=e("p5Bo"),r=e("oYx3"),l={name:"transactionDetail",props:{transHash:{type:String}},data:function(){return{detail:null,transactionData:{},contractList:[],decodeData:{},funcData:"",showDecode:!1,buttonTitle:"还原",eventTitle:"还原",abiType:[],methodId:"",inputData:[],eventLog:[],buttonSHow:!1,eventSHow:!1,transactionTo:null,bin:"",createTime:null,eventDataShow:!0,inputButtonShow:!0,eventButtonShow:!0,userList:[]}},mounted:function(){this.getContacts(this.getHashTransactionInfo),this.getUser()},destroyed:function(){localStorage.setItem("transaction","")},methods:{link:function(t){r.a.push({path:"/rivateKeyManagement",query:{userName:t}})},copyPubilcKey:function(t){var a=this;t?this.$copyText(t).then(function(t){a.$message({type:"success",showClose:!0,message:"复制成功",duration:2e3})}):this.$message({type:"fail",showClose:!0,message:"key为空，不复制。",duration:2e3})},getHashTransactionInfo:function(){var t=this,a={networkId:localStorage.getItem("networkId"),transHash:this.transHash};Object(i.y)(a,{}).then(function(a){0===a.data.code?(t.transactionData=a.data.data,a.data.data?(t.getCreatTime(a.data.data.blockNumber),t.getAdderss()):t.$message({type:"error",message:"无法查询到交易信息"})):t.$message({type:"error",message:c.a.errCode[a.data.code].cn})}).catch(function(a){t.$message({type:"error",message:"系统错误!"})})},getUser:function(){var t=this,a={networkId:localStorage.getItem("networkId"),pageNumber:1,pageSize:1e3};Object(i.x)(a).then(function(a){0===a.data.code?t.userList=a.data.data:t.$message({type:"error",message:c.a.errCode[response.data.code].cn})}).catch(function(a){t.$message({type:"error",message:"系统错误!"})})},getCreatTime:function(t){var a=this,e={networkId:localStorage.getItem("networkId"),blockNumber:t};Object(i.l)(e).then(function(t){0===t.data.code?a.createTime=Object(o.f)(t.data.data.timestamp):a.$message({type:"error",message:c.a.errCode[response.data.code].cn})}).catch(function(t){a.$message({type:"error",message:"系统错误!"})})},handleClick:function(t,a){"event"==t.label&&this.decodeEventClick()},decode:function(){this.showDecode?(this.buttonTitle="还原",this.showDecode=!1):(this.buttonTitle="解码",this.showDecode=!0),this.eventDataShow?(this.buttonTitle="解码",this.eventDataShow=!1):(this.buttonTitle="还原",this.eventDataShow=!0)},getBin:function(t,a,e){var n=this,s={networkId:localStorage.getItem("networkId"),address:t,blockNumber:a};Object(i.n)(s,{}).then(function(t){0===t.data.code?(n.bin=t.data.data.code,e()):n.$message({type:"error",message:c.a.errCode[t.data.code].cn})}).catch(function(t){n.$message({type:"error",message:"系统错误!"})})},getEventBin:function(t,a,e,n,s){var o=this,r={networkId:localStorage.getItem("networkId"),address:t,blockNumber:a};Object(i.n)(r,{}).then(function(t){0===t.data.code?(o.bin=t.data.data.code,e(t.data.data.code,n,s)):o.$message({type:"error",message:c.a.errCode[t.data.code].cn})}).catch(function(t){o.$message({type:"error",message:"系统错误!"})})},getContacts:function(t){var a=this,e={networkId:localStorage.getItem("networkId"),pageSize:1,pageNumber:1e3};Object(i.p)(e,{}).then(function(e){0===e.data.code?(a.contractList=e.data.data||[],t()):a.$message({type:"error",message:c.a.errCode[e.data.code].cn})}).catch(function(t){a.$message({type:"error",message:"系统错误!"})})},decodeAbi:function(t,a){var e=this;this.inputButtonShow=!0;var n=this.transactionData.input;this.transactionTo=this.transactionData.to,this.userList.length&&this.userList.forEach(function(t){t.address==e.transactionData.from&&(e.transactionData.user=t.userName)}),this.transactionTo?this.decodefun(n,this.transactionTo):(this.methodId=n.substring(0,10),this.decodeDeloy(this.bin))},getAdderss:function(){var t=this,a={networkId:localStorage.getItem("networkId"),transHash:this.transHash};Object(i.v)(a,{}).then(function(a){0===a.data.code?(t.eventLog=a.data.data.logs,t.transactionData.to?t.getBin(t.transactionData.to,a.data.data.blockNumber,t.decodeAbi):t.getBin(a.data.data.contractAddress,a.data.data.blockNumber,t.decodeAbi)):t.$message({type:"error",message:c.a.errCode[a.data.code].cn})}).catch(function(a){t.$message({type:"error",message:"系统错误！"})})},decodeEventClick:function(){if(this.eventLog.length){this.eventSHow=!0;for(var t=0;t<this.eventLog.length;t++)this.getEventBin(this.eventLog[t].address,this.eventLog[t].blockNumber,this.decodeEvent,this.eventLog[t],t)}else this.eventSHow=!1},decodeEvent:function(t,a,e){var n=this,i=new Web3(Web3.givenProvider),o=a;t=t.substring(2);for(var c=function(a){var e=0;n.contractList.forEach(function(a){a.contractBin===t?a.contractAbi?o.abi=JSON.parse(a.contractAbi):o.abi=[]:e++}),o.eventDataShow=!0,o.eventButtonShow=!0,e==n.contractList.length&&(o.eventDataShow=!1,o.eventButtonShow=!1)},r=0;r<this.eventLog.length;r++)c();o.abi&&o.abi.length&&o.abi.forEach(function(t){if("event"==t.type){o.eventName=t.name+"(";for(var a=0;a<t.inputs.length;a++)a==t.inputs.length-1?o.eventName=o.eventName+t.inputs[a].type+" "+t.inputs[a].name:o.eventName=o.eventName+t.inputs[a].type+" "+t.inputs[a].name+",";o.eventName=o.eventName+")";var e=i.eth.abi.decodeLog(t.inputs,o.data,o.topics);for(var n in o.outData={},o.eventLgData=[],e)(+n||0==+n)&&(o.outData[n]=e[n]);if(t.inputs.length&&"{}"!=s()(o.outData)){var c=function(a){t.inputs.forEach(function(t,e){e==a&&(o.eventLgData[e]={},o.eventLgData[e].name=t.name,o.eventLgData[e].data=o.outData[a])})};for(var r in o.outData)c(r)}}}),this.$set(this.eventLog,e,o)},decodefun:function(t,a){var e=this,n=new Web3(Web3.givenProvider),i=t.substring(0,10);this.methodId=i;var o="0x"+t.substring(10),c="",r={};this.bin=this.bin.substring(2);var l=0;this.contractList.length&&(this.contractList.forEach(function(t){t.contractBin===e.bin?(c=t.contractAbi,e.buttonSHow=!0):l++}),l==this.contractList.length&&(this.showDecode=!0,this.inputButtonShow=!1)),c&&((r=JSON.parse(c)).forEach(function(t){t.encode=n.eth.abi.encodeFunctionSignature({name:t.name,type:t.type,inputs:t.inputs})}),r.forEach(function(t){if(t.encode===i&&(t.inputs.forEach(function(t,a){t&&t.type&&t.name?e.abiType[a]=t.type+" "+t.name:t&&t.name?e.abiType[a]=t.name:t&&t.type?e.abiType[a]=t.type:t&&(e.abiType[a]=t)}),e.funcData=t.name,t.inputs.length&&(e.decodeData=n.eth.abi.decodeParameters(t.inputs,o),"{}"!=s()(e.decodeData)))){var a=function(a){t.inputs.forEach(function(t,n){t&&t.name&&t.type?a===t.name&&(e.inputData[n]={},e.inputData[n].name=t.name,e.inputData[n].type=t.type,e.inputData[n].data=e.decodeData[a]):t&&n==a&&(e.inputData[n]={},e.inputData[n].type=t,e.inputData[n].data=e.decodeData[a])})};for(var c in e.decodeData)a(c)}}))},decodeDeloy:function(t){var a=this,e="",n="",s={},i=0;t=t.substring(2),this.contractList.length&&(this.contractList.forEach(function(s){s.contractBin===t?(e=s.contractAbi,n=s.contractName,a.buttonSHow=!0):i++}),i==this.contractList.length&&(this.showDecode=!0,this.inputButtonShow=!1)),e&&(s=JSON.parse(e)).length>0&&s.forEach(function(t){"constructor"===t.type||t.name===n?(a.funcData=n,t.inputs.forEach(function(t,e){t&&t.type&&t.name?a.abiType[e]=t.type+" "+t.name:t&&t.name?a.abiType[e]=t.name:t&&t.type?a.abiType[e]=t.type:t&&(a.abiType[e]=t)})):(a.showDecode=!0,a.inputButtonShow=!1)})}}},d=(e("16me"),e("KHd+")),u=Object(d.a)(l,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{padding:"0"}},[e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick}},[e("el-tab-pane",{attrs:{label:"input"}},[e("div",[e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("Block Height:")]),t._v(" "),e("span",[t._v(t._s(t.transactionData.blockNumber))])]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("From:")]),t._v(" "),e("span",{staticClass:"input-data-from"},[e("span",[t._v(t._s(t.transactionData.from))]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.transactionData&&t.transactionData.user,expression:"transactionData && transactionData.user"}]},[t._v("=>")]),t._v(" "),e("span",{staticClass:"link",on:{click:function(a){t.link(t.transactionData.user)}}},[t._v(t._s(t.transactionData.user))])])]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"部署合约，to字段为空。",placement:"top-start"}},[e("i",{staticClass:"el-icon-info"})]),t._v(" "),e("span",[t._v("To:")])],1),t._v(" "),e("span",[t._v(t._s(t.transactionData.to||"null"))])]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("Timestamp:")]),t._v(" "),e("span",[t._v(t._s(t.createTime))])]),t._v(" "),e("div",{staticClass:"item",staticStyle:{"font-size":"0"}},[e("span",{staticClass:"label"},[t._v("Input:")]),t._v(" "),e("div",{staticClass:"detail-input-content"},[t.showDecode?e("span",{staticClass:"input-data"},[t._v(t._s(t.transactionData.input))]):t._e(),t.showDecode?e("br"):t._e(),t._v(" "),t.showDecode?t._e():e("div",{staticClass:"input-data"},[e("div",{staticClass:"input-label"},[e("span",{staticClass:"label"},[t._v("function")]),t._v(" "),e("span",[t._v(t._s(t.funcData+"("+t.abiType+")"))])]),t._v(" "),e("div",{staticClass:"input-label"},[e("span",{staticClass:"label"},[t._v("methodId")]),t._v(" "),e("span",[t._v(t._s(t.methodId))])]),t._v(" "),e("div",{staticClass:"input-label"},[e("span",{staticClass:"label"},[t._v("data")]),t._v(" "),t.inputData.length?e("el-table",{staticStyle:{display:"inline-block",width:"400px"},attrs:{data:t.inputData}},[t.inputData[0].name?e("el-table-column",{attrs:{prop:"name",label:"name",align:"left"}}):t._e(),t._v(" "),e("el-table-column",{attrs:{prop:"type",label:"type",align:"left"}}),t._v(" "),e("el-table-column",{attrs:{prop:"data",label:"data",align:"left","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"wbs-icon-baocun font-12 copy-public-key",attrs:{title:"复制"},on:{click:function(e){t.copyPubilcKey(a.row.data)}}}),t._v(" "),e("span",[t._v(t._s(a.row.data))])]}}])})],1):t._e()],1)])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.inputButtonShow,expression:"inputButtonShow"}],staticClass:"item"},[e("span",{staticClass:"label"}),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.decode}},[t._v(t._s(t.buttonTitle))])],1)])])]),t._v(" "),t.eventLog.length>0?e("el-tab-pane",{attrs:{label:"event"},on:{click:t.decodeEventClick}},t._l(t.eventLog,function(a){return t.eventSHow?e("div",[e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("Address :")]),t._v(" "),e("span",[t._v(t._s(a.address))])]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("Name :")]),t._v(" "),e("span",[t._v(t._s(a.eventName))])]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("Topics :")]),t._v(" "),e("div",{staticStyle:{display:"inline-block",width:"800px"}},t._l(a.topics,function(a,n){return e("div",[t._v("["+t._s(n)+"] "+t._s(a))])}),0)]),t._v(" "),e("div",{staticClass:"item"},[e("span",{staticClass:"label"},[t._v("Data :")]),t._v(" "),e("div",{staticClass:"detail-input-content"},[a.eventDataShow?t._e():e("span",{staticClass:"input-data"},[t._v(t._s(a.data))]),t._v(" "),e("el-table",{directives:[{name:"show",rawName:"v-show",value:a.eventDataShow,expression:"item.eventDataShow"}],staticClass:"input-data",staticStyle:{display:"inline-block",width:"100%"},attrs:{data:a.eventLgData}},[e("el-table-column",{attrs:{prop:"name",width:"150",label:"name",align:"left"}}),t._v(" "),e("el-table-column",{attrs:{prop:"data",label:"data",align:"left","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"wbs-icon-baocun font-12 copy-public-key",attrs:{title:"复制"},on:{click:function(e){t.copyPubilcKey(a.row.data)}}}),t._v(" "),e("span",[t._v(t._s(a.row.data))])]}}])})],1)],1)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:a.eventButtonShow,expression:"item.eventButtonShow"}],staticClass:"item"},[e("span",{staticClass:"label"}),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.decode}},[t._v(t._s(t.eventTitle))])],1)]):t._e()}),0):t._e()],1)],1)},[],!1,null,"0ad17922",null);a.a=u.exports},d83Z:function(t,a,e){"use strict";e.r(a);var n=e("qse9"),s=e("bxjF"),i=e("mHBk"),o={name:"unusualContract",components:{contentHead:n.a,transactionDetail:s.a},data:function(){return{loading:!1,currentPage:1,pageSize:10,total:0,contractAddress:"",unusualContractHead:[{enName:"contractAddress",name:"合约地址"},{enName:"transCount",name:"交易量"},{enName:"time",name:"最新交易时间"},{enName:"hashs",name:"hash"}],unusualContractList:[]}},computed:{hashData:function(){var t=this.unusualContractList;return t.forEach(function(t){t.hashs=t.hashs.split(",")}),t.forEach(function(t){for(var a=[],e=0;e<t.hashs.length;e++){var n={};0===e?(n.hash=t.hashs[e],n.show=!0):(n.hash=t.hashs[e],n.show=!1),a.push(n)}t.hashs=a}),t}},mounted:function(){this.getUnusualContractList()},methods:{getUnusualContractList:function(){var t=this;this.loading=!0;var a,e={networkId:localStorage.getItem("networkId"),pageNumber:this.currentPage,pageSize:this.pageSize};a={contractAddress:this.contractAddress},Object(i.L)(e,a).then(function(a){0===a.data.code?(t.unusualContractList=a.data.data,t.total=a.data.totalCount,t.loading=!1):(t.loading=!1,t.$message({message:t.errcode.errCode[a.data.code].cn,type:"error",duration:2e3}))}).catch(function(a){t.loading=!1,t.$message({message:t.errcode.errCode[a.data.code].cn||"查询异常合约失败！",type:"error",duration:2e3})})},hashList:function(t){return t.split(",")},showItem:function(t){this.$set(t,"show",!t.show)},search:function(){this.getUnusualContractList()},handleSizeChange:function(t){this.pageSize=t,this.currentPage=1,this.getUnusualContractList()},handleCurrentChange:function(t){this.currentPage=t,this.getUnusualContractList()}}},c=(e("3OG1"),e("KHd+")),r=Object(c.a)(o,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"100%"}},[e("content-head",{attrs:{headTitle:"交易审计",headSubTitle:"异常合约"}}),t._v(" "),e("div",{staticClass:"module-wrapper auto-wrapper"},[e("div",{staticClass:"search-part"},[e("div",{staticClass:"search-part-right"},[e("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入合约地址"},model:{value:t.contractAddress,callback:function(a){t.contractAddress=a},expression:"contractAddress"}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.search},slot:"append"})],1)],1)]),t._v(" "),e("div",{staticClass:"search-table",staticStyle:{height:"76%"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.hashData,"tooltip-effect":"light",height:"100%"}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("ul",{staticClass:"expand-item-ul"},t._l(a.row.hashs,function(a){return e("li",[e("div",{staticClass:"expand-item-div",on:{click:function(e){t.showItem(a)}}},[e("i",{class:a.show?"el-icon-arrow-down":"el-icon-arrow-up"}),t._v(" "),e("span",{staticClass:"expand-item-span"},[t._v("TxHash：\n                                        "),e("span",[t._v(t._s(a.hash))])])]),t._v(" "),a.show?e("transaction-detail",{attrs:{transHash:a.hash}}):t._e()],1)}),0)]}}])}),t._v(" "),t._l(t.unusualContractHead,function(a){return"hashs"!==a.enName?e("el-table-column",{key:a.enName,attrs:{label:a.name,"show-overflow-tooltip":"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("span",[t._v(t._s(n.row[a.enName]))])]}}])}):t._e()})],2),t._v(" "),e("el-pagination",{staticClass:"page",attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1)},[],!1,null,"75b6f368",null);a.default=r.exports},"o+l6":function(t,a,e){}}]);