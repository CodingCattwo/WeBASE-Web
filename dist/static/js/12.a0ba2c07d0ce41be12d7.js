(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"4p3j":function(e,t,o){"use strict";var r=o("S+Zx");o.n(r).a},Atqu:function(e,t,o){},"S+Zx":function(e,t,o){},U3a8:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("v-content-head",{attrs:{headTitle:"节点管理"}}),e._v(" "),o("div",{staticClass:"module-wrapper"},[o("div",{staticClass:"search-part"},[o("div",{staticClass:"search-part-left"},[o("el-button",{staticClass:"search-part-left-btn",attrs:{type:"primary"},on:{click:e.createFront}},[e._v("新增节点")])],1),e._v(" "),o("div",{staticClass:"search-part-right"},[o("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入节点ip"},model:{value:e.frontId,callback:function(t){e.frontId=t},expression:"frontId"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),o("div",{staticClass:"search-table"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"search-table-content",attrs:{data:e.frontData}},[e._l(e.nodeHead,function(t){return o("el-table-column",{key:t.enName,attrs:{label:t.name,"show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return["frontIp"!=t.enName?o("span",[e._v(e._s(r.row[t.enName]))]):o("span",[o("router-link",{staticClass:"link",attrs:{to:{path:"nodesMetric",query:{nodeIp:r.row.frontIp,nodeId:r.row.frontId}}}},[e._v(e._s(r.row[t.enName]))])],1)]}}],null,!0)})}),e._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){return e.deletedFront(t.row)}}},[e._v("删除")])]}}])})],2),e._v(" "),o("el-pagination",{staticClass:"page",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),e.frontShow?o("v-setFront",{attrs:{show:e.frontShow,showClose:!0},on:{close:e.close}}):e._e()],1)])],1)};r._withStripped=!0;var n=o("qse9"),s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-form",{ref:"nodesForm",staticClass:"demo-ruleForm",attrs:{model:e.nodesForm,rules:e.rules,"label-width":"108px"}},[o("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"节点IP",prop:"nodeIp"}},[o("el-input",{attrs:{placeholder:"请输入IP",disabled:e.nodesForm.disabled},model:{value:e.nodesForm.nodeIp,callback:function(t){e.$set(e.nodesForm,"nodeIp",t)},expression:"nodesForm.nodeIp"}})],1),e._v(" "),e.nodesForm.dShow?o("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"前置服务端口",prop:"frontPort"}},[o("el-input",{attrs:{placeholder:"请输入前置服务端口",disabled:e.nodesForm.disabled},model:{value:e.nodesForm.frontPort,callback:function(t){e.$set(e.nodesForm,"frontPort",t)},expression:"nodesForm.frontPort"}})],1):e._e()],1),e._v(" "),o("div",{staticClass:"dialog-footer"},[o("el-button",{on:{click:e.modelClose}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submit("nodesForm")}}},[e._v("确 定")])],1)],1)};s._withStripped=!0;var a=o("P2sY"),i=o.n(a),l=o("mHBk"),d=(o("bCcq").sha256,{name:"nodesDialog",props:{nodesDialogOptions:{type:Object}},watch:{"nodesDialogOptions.type":{handler:function(e){switch(this.type=e,e){case"creat":this.nodesForm={nodeIp:"",org:"1",frontPort:"",disabled:!1,mDisabled:!1,dShow:!0};break;case"delete":this.nodesForm={nodeIp:this.nodesDialogOptions.data.nodeIp,nodeId:this.nodesDialogOptions.data.nodeId,disabled:!0,mDisabled:!0,dShow:!1}}},deep:!0,immediate:!0}},data:function(){return{type:this.nodesDialogOptions.type,loading:!1,nodesForm:{},rules:{nodeIp:[{required:!0,message:"请输入IP",trigger:"blur"},{pattern:/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,message:"IP格式不正确",trigger:"blur"}],frontPort:[{required:!0,message:"请输入端口",trigger:"blur"},{pattern:/^[1-9]\d*$/,message:"请输入正确端口号",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 个字符",trigger:"blur"}]}}},mounted:function(){},methods:{modelClose:function(){this.nodesForm=i()({nodeIp:"",frontPort:""}),this.$emit("close",!1)},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.getAllAccountInfo()})},getAllAccountInfo:function(){switch(this.type){case"creat":this.getCreatNodesInfo();break;case"delete":this.getDeleteNodesInfo()}},getCreatNodesInfo:function(){var e=this,t={groupId:localStorage.getItem("groupId"),nodeIp:this.nodesForm.nodeIp,nodeType:this.nodesForm.org,frontPort:this.nodesForm.frontPort};Object(l.d)(t,{}).then(function(t){e.loading=!1,0===t.data.code?(e.$message({type:"success",message:"新增成功"}),e.modelClose(),e.$emit("success")):(e.modelClose(),e.$message({type:"error",message:e.errcode.errCode[t.data.code].cn}))}).catch(function(t){e.modelClose(),e.$message({type:"error",message:e.errcode.errCode[t.data.code].cn||"系统错误"})})},getDeleteNodesInfo:function(){var e=this;Object(l.j)(this.nodesForm.nodeId,{}).then(function(t){e.loading=!1,0===t.data.code?(e.$message({type:"success",message:"删除成功"}),e.modelClose(),e.$emit("success")):(e.modelClose(),e.$message({type:"error",message:e.errcode.errCode[t.data.code].cn}))}).catch(function(t){e.modelClose(),e.$message({type:"error",message:e.errcode.errCode[t.data.code].cn||"系统错误"})})}}}),c=(o("4p3j"),o("KHd+")),u=Object(c.a)(d,s,[],!1,null,"5cd57ea0",null);u.options.__file="src/views/front/components/nodesDialog.vue";u.exports,o("DgvE");var m=o("p5Bo"),p=o("cNqd"),f={name:"node",components:{"v-content-head":n.a,"v-setFront":p.a},watch:{$route:function(){this.urlQuery=this.$root.$route.query}},data:function(){return{frontShow:!1,nodeName:"",nodes:[],frontData:[],currentPage:1,pageSize:10,total:0,loading:!1,nodesLoading:!1,nodesDialogVisible:!1,nodesDialogTitle:"",nodesDialogOptions:{},frontId:null,nodeHead:[{enName:"frontId",name:"前置编号"},{enName:"frontIp",name:"ip"},{enName:"frontPort",name:"前置端口"},{enName:"createTime",name:"创建时间"},{enName:"modifyTime",name:"修改时间"}],urlQuery:this.$root.$route.query}},mounted:function(){this.getFrontTable()},methods:{search:function(){this.getFrontTable()},getFrontTable:function(){var e=this,t={frontId:this.frontId};Object(l.t)(t).then(function(t){0===t.data.code?(e.total=t.data.totalCount,e.frontData=t.data.data||[],e.loading=!1):(e.loading=!1,e.$message({message:m.a.errCode[t.data.code].cn,type:"error",duration:2e3}))}).catch(function(t){e.loading=!1,e.$message({message:"查询失败！",type:"error",duration:2e3})})},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.getFrontTable()},handleCurrentChange:function(e){this.currentPage=e,this.getFrontTable()},textColor:function(e){var t="";switch(e){case 1:t="#58cb7d";break;case 2:t="#ed5454"}return t},nodesStatus:function(e){var t="";switch(e){case 1:t="运行";break;case 2:t="停止"}return t},createFront:function(){this.frontShow=!0},deleteNodes:function(e,t){this.nodesDialogOptions={type:t,data:e},this.nodesDialogVisible=!0,this.nodesDialogTitle="删除节点"},close:function(e){this.frontShow=!1,this.getFrontTable()},showDetail:function(e){2!==e.nodeType&&this.$router.push({path:"hostDetail",query:{nodeIp:e.nodeIp,nodeId:e.nodeId}})},deletedFront:function(e){var t=this;Object(l.i)(e.frontId).then(function(e){0===e.data.code?t.getFrontTable():t.$message({message:m.a.errCode[e.data.code].cn,type:"error",duration:2e3})}).catch(function(e){t.$message({message:"系统错误",type:"error",duration:2e3})})}}},g=(o("UXI7"),Object(c.a)(f,r,[],!1,null,"839e75ce",null));g.options.__file="src/views/front/front.vue";t.default=g.exports},UXI7:function(e,t,o){"use strict";var r=o("Atqu");o.n(r).a},cNqd:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{staticClass:"dialog-wrapper",attrs:{title:"节点配置",visible:e.dialogVisible,"before-close":e.modelClose,width:"433px",center:!0,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("div",[o("el-form",{ref:"frontFrom",staticClass:"demo-ruleForm",attrs:{model:e.frontFrom,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"ip",prop:"ip"}},[o("el-input",{model:{value:e.frontFrom.ip,callback:function(t){e.$set(e.frontFrom,"ip",t)},expression:"frontFrom.ip"}})],1),e._v(" "),o("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"前置端口",prop:"port"}},[o("el-input",{model:{value:e.frontFrom.port,callback:function(t){e.$set(e.frontFrom,"port",t)},expression:"frontFrom.port"}})],1),e._v(" "),o("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"所属机构",prop:"company"}},[o("el-input",{model:{value:e.frontFrom.company,callback:function(t){e.$set(e.frontFrom,"company",t)},expression:"frontFrom.company"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.closeVisible?o("el-button",{on:{click:e.modelClose}},[e._v("取 消")]):e._e(),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("frontFrom")}}},[e._v("确 定")])],1)])],1)};r._withStripped=!0;var n=o("mHBk"),s={name:"setFront",props:["show","showClose"],data:function(){return{dialogVisible:this.show,closeVisible:this.showClose||!1,frontFrom:{ip:"",port:"",company:""},rules:{ip:[{required:!0,message:"请输入ip名称",trigger:"blur"},{pattern:/((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))/,message:"ip不符合规则",trigger:"blur"}],port:[{required:!0,message:"请输入端口名称",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 个数字",trigger:"blur"},{pattern:/^[0-9]*[1-9][0-9]*$/,message:"端口不符合规则",trigger:"blur"}],company:[{required:!0,message:"请输入机构名称",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 位",trigger:"blur"},{pattern:/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_]){1,20}$/,message:"机构名称请输入中文、英文和数字",trigger:"blur"}]}}},methods:{submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.setFront()})},setFront:function(){var e=this,t={frontIp:this.frontFrom.ip,frontPort:this.frontFrom.port,agency:this.frontFrom.company};Object(n.b)(t).then(function(t){0===t.data.code?(e.$message({message:"添加前置成功",type:"success"}),e.$emit("close")):e.$message({message:errcode.errCode[t.data.code].cn||"添加前置失败",type:"error"})}).catch(function(t){e.$message({message:"系统错误",type:"error"})})},modelClose:function(){this.$emit("close")}}},a=o("KHd+"),i=Object(a.a)(s,r,[],!1,null,null,null);i.options.__file="src/views/index/dialog/setFront.vue";t.a=i.exports}}]);