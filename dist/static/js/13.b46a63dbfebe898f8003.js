(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{Dij7:function(t,e,a){"use strict";var i=a("biRd");a.n(i).a},HAXt:function(t,e,a){"use strict";var i=a("SLYa");a.n(i).a},SLYa:function(t,e,a){},biRd:function(t,e,a){},xrW5:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-content-head",{attrs:{headTitle:"交易审计",headSubTitle:t.headSubTitle}}),t._v(" "),a("div",{staticClass:"module-wrapper"},[a("div",{staticClass:"more-search-table search-min-width"},[a("div",{staticClass:"text-left"},[a("div",{staticClass:"text-left-label"},[a("span",[t._v("用户：")]),t._v(" "),a("el-select",{staticClass:"select-32",attrs:{clearable:""},on:{change:t.changeUserName},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}},t._l(t.userList,function(e){return a("el-option",{key:e.userName,attrs:{label:e.userName,value:e.userName}},[0==e.userType?a("span",[t._v(t._s(e.userName))]):a("span",{staticClass:"font-color-ed5454"},[t._v(t._s(e.userName))])])}),1)],1),t._v(" "),a("div",{staticClass:"text-left-label"},[a("span",{staticClass:"text-left-label-title"},[t._v("时长：")]),t._v(" "),a("el-date-picker",{staticClass:"date-select-32",attrs:{type:"datetimerange","picker-options":t.transPickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"left","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:t.changeDate},model:{value:t.transDate,callback:function(e){t.transDate=e},expression:"transDate"}})],1),t._v(" "),a("div",{staticClass:"text-left-label1"},[a("span",{staticClass:"text-left-label1-title"},[t._v("接口：")]),t._v(" "),a("el-select",{staticClass:"select-32",attrs:{clearable:""},on:{change:t.changeInterfaceName},model:{value:t.interfaceName,callback:function(e){t.interfaceName=e},expression:"interfaceName"}},t._l(t.interfaceList,function(e){return a("el-option",{key:e.interfaceName,attrs:{label:e.interfaceName,value:e.interfaceName}},[0==e.transUnusualType?a("span",[t._v(t._s(e.interfaceName))]):a("span",{staticClass:"font-color-ed5454"},[t._v(t._s(e.interfaceName))])])}),1)],1)]),t._v(" "),a("div",{staticClass:"divide-line"})]),t._v(" "),a("div",{ref:"chart",staticClass:"chart"},[t.chartStatistics.show?a("v-chart",{ref:"linechart",attrs:{id:"transId",chartStatistics:t.chartStatistics,reload:t.reloadNum}}):t._e()],1)])],1)};i._withStripped=!0;var s=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"padding-left":"30px"}},[e("div",{staticClass:"charts-title text-left"},[e("span",{staticClass:"total-count"},[this._v("当前总数量："+this._s(this.numberFormat(this.chartStatistics.totalCount,0,".",",")))])]),this._v(" "),e("div",{staticStyle:{"min-width":"250px",height:"476px",margin:"0 auto"},attrs:{id:this.chartId}})])};s._withStripped=!0;var r=a("DgvE"),n=a("ProS");a("75ce"),a("Ynxi"),a("AH3D"),a("zRKj"),a("0o9m"),a("Cm0C");var c={name:"charts",props:{chartStatistics:{type:Object},id:{type:String},reload:{type:Number}},data:function(){return{chartId:this.id,chartSize:this.chartStatistics.chartSize,chart:"",numberFormat:r.g}},watch:{reload:{handler:function(t){n.init(document.getElementById(this.chartId)).showLoading(),this.chartShow()}}},mounted:function(){this.$nextTick(function(){this.chartShow()})},beforeDestroy:function(){var t=this;window.onresize=null,this.chart&&setTimeout(function(){t.chart.dispose()},600)},methods:{chartShow:function(){var t=this;this.chart=n.init(document.getElementById(this.chartId)),setTimeout(function(){t.chart.hideLoading()},600);var e=this.chartStatistics.data.length,a=0;0<=e&&e<28?a=0:28<=e&&e<60?a=1:60<=e&&e<80?a=2:80<=e&&e<100?a=4:100<=e&&e<120?a=6:e>=120&&(a=8);var i={legend:{height:this.chartSize.height,width:this.chartSize.width},noDataLoadingOption:{text:"暂无数据",effect:"bubble",effectOption:{effect:{n:0}}},default:{text:"loading",color:"#2878ff",textColor:"#2878ff",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0},tooltip:{show:!0,trigger:"axis",formatter:function(t){return'<span style="font-size:10px">'+t[0].name+'</span><br><table ><tr><td style="padding:0"><span style="font-size:10px;color:white">交易量：'+t[0].value+"笔</a></span><br></td></tr></table>"}},grid:{left:43,right:33,top:5,bottom:60},series:[{type:"line",symbolSize:1,itemStyle:{normal:{color:"#2878ff",lineStyle:{color:"#2878ff"}}},smooth:!0,symbol:"none",data:this.chartStatistics.transactionDataArr}],xAxis:{data:this.chartStatistics.data,axisLine:{lineStyle:{color:"#e9e9e9",width:2}},axisLabel:{interval:a,rotate:0,textStyle:{color:"rgba(0,14,31,0.62)"},fontSize:10}},yAxis:{axisLine:{show:!1,lineStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:"#e9e9e9"}},axisTick:{show:!1},axisLabel:{formatter:function(t,e){return t>1e3&&t<1e6?t/1e3+"K":t>1e6||1e6===t?t/1e6+"M":t+""},textStyle:{color:"rgba(0,14,31,0.62)"}}}};this.chart.setOption(i,!0),window.onresize=function(){t.chart.resize()}}}},o=(a("Dij7"),a("KHd+")),l=Object(o.a)(c,s,[],!1,null,null,null);l.options.__file="src/views/transactionCharts/components/chart.vue";var h=l.exports,d=a("qse9"),u=a("mHBk"),f={name:"transactionCharts",components:{"v-content-head":d.a,"v-chart":h},data:function(){return{networkId:localStorage.getItem("networkId"),headSubTitle:"用户交易",reloadNum:1,chartStatistics:{show:!0,data:[],transactionDataArr:[],chartSize:{width:0,height:0},totalCount:""},userList:[],interfaceList:[],userName:"",interfaceName:"",transDate:[],transPickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date,i=a.getTime();a.setTime(i-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date,i=a.getTime();a.setTime(i-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date,i=a.getTime();a.setTime(i-7776e6),t.$emit("pick",[a,e])}}],disabledDate:function(t){return t.getTime()>Date.now()-864e4}}}},mounted:function(){var t=this;this.$nextTick(function(){t.chartStatistics.chartSize.width=t.$refs.chart.offsetWidth,t.chartStatistics.chartSize.height=t.$refs.chart.offsetHeight,t.getMonitorTransactionInfo(),t.getMonitorUserList()})},methods:{getMonitorTransactionInfo:function(){var t=this,e={networkId:this.networkId},a={};a={userName:this.userName,interfaceName:this.interfaceName},this.transDate&&(a.startDate=this.transDate[0],a.endDate=this.transDate[1]),Object(u.D)(e,a).then(function(e){if(0==e.data.code){var a=e.data.data.transInfoList,i=a.length;if(0===i)t.$set(t.chartStatistics,"data",[]),t.$set(t.chartStatistics,"transactionDataArr",[]),t.$set(t.chartStatistics,"totalCount",0);else{var s=Object(r.d)(new Date(a[0].time).getTime(),"yyyy-MM-dd"),n=Object(r.d)(new Date(a[i-1].time).getTime(),"yyyy-MM-dd");a.forEach(function(t){t.time=Object(r.d)(new Date(t.time).getTime(),"MM-dd")});var c={};a.forEach(function(t){var e=c[t.time];e?e+=t.transCount:e=t.transCount,c[t.time]=e});var o=[],l={};for(var h in c)l={transCount:c[h],time:h},o.push(l);var d=(o=Object(r.b)(s,n,o)).map(function(t){return t.time}),u=o.map(function(t){return t.transCount});t.$set(t.chartStatistics,"data",d),t.$set(t.chartStatistics,"transactionDataArr",u),t.$set(t.chartStatistics,"totalCount",e.data.data.totalCount)}t.reloadNum++}else t.$message({type:"error",message:t.errcode.errCode[e.data.code].cn})}).catch(function(e){t.$message({type:"error",message:t.errcode.errCode[e.data.code].cn||"获取监管用户列表失败！"})})},getMonitorUserList:function(){var t=this,e={networkId:this.networkId};Object(u.F)(e,{}).then(function(e){0==e.data.code?t.userList=e.data.data:t.$message({type:"error",message:t.errcode.errCode[e.data.code].cn})}).catch(function(e){t.$message({type:"error",message:t.errcode.errCode[e.data.code].cn||"获取监管用户列表失败！"})})},getMonitorUserInterfaceList:function(t){var e,a=this,i={networkId:this.networkId};e={userName:t},Object(u.E)(i,e).then(function(t){0==t.data.code?a.interfaceList=t.data.data:a.$message({type:"error",message:a.errcode.errCode[t.data.code].cn})}).catch(function(t){a.$message({type:"error",message:a.errcode.errCode[t.data.code].cn||"获取监管用户列表失败！"})})},changeUserName:function(t){this.getMonitorUserInterfaceList(t),this.getMonitorTransactionInfo()},changeDate:function(){this.getMonitorTransactionInfo()},changeInterfaceName:function(){this.getMonitorTransactionInfo()}}},m=(a("HAXt"),Object(o.a)(f,i,[],!1,null,"532180ed",null));m.options.__file="src/views/transactionCharts/transactionCharts.vue";e.default=m.exports}}]);